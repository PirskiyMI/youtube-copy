import{r,s as w,t as E,j as e,v as S,A as V,u as d,w as R,x as U,y as W,b as h,z as Y,B as y,C as A,D as G,R as J,E as K,F as l,G as Q,H as X,I as N,J as g,K as Z,M as $,q as v,d as ee,N as D,O as P,p as F,Q as se,S as te,T as ne,U as oe,W as ie,X as p,Y as x,Z as b,_ as f,$ as ce,a0 as ae,a1 as re,a2 as le,a3 as de,a4 as me,a5 as I,a6 as ue,a7 as he,a8 as _,i as xe,a9 as pe,aa as _e,ab as je,ac as fe,ad as ge,ae as Ce,af as Se,ag as Ne}from"./index-R4FHraQG.js";import{P as be}from"./index-Dcd-epSQ.js";const B=()=>{const[t,s]=r.useState(!1);return{isPopupVisible:t,showPopup:()=>s(!0),hidePopup:()=>s(!1)}},M=()=>{const[t,s]=r.useState(!1),[o,n]=r.useState(!1),i=r.useRef(null);return r.useEffect(()=>{i.current&&n(i.current.clientHeight!==i.current.scrollHeight)},[]),{isTextShow:t,isButtonShow:o,ref:i,toggleIsTextShow:()=>s(!t)}},ke=({title:t,subscriberCount:s})=>{const o=w(s),n=E(Number(s),"подписчик","подписчика","подписчиков");return e.jsxs("div",{className:S.channel,children:[e.jsx(V,{}),e.jsxs("div",{className:S.channel__info,children:[e.jsx("h4",{className:S.channel__title,children:t}),e.jsxs("span",{children:[o," ",n]})]})]})},ve=({channelId:t})=>{d(R);const s=d(U),o=d(W),n=h();return r.useEffect(()=>{n(Y(t))},[t]),e.jsx(ke,{title:s,subscriberCount:o})},we=t=>t.videoPlayer.title,Ve=({src:t})=>{const{setVideoId:s}=A,o=h();return r.useEffect(()=>{o(s(t))},[t,o]),e.jsx("div",{className:y.video,children:e.jsx("iframe",{className:y.video__iframe,src:t,title:"YouTube video player",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",referrerPolicy:"strict-origin-when-cross-origin",allowFullScreen:!0})})},Le=t=>t.relatedVideo,T=()=>{const{clearVideoList:t}=K,{videoList:s,loading:o}=d(Le),n=d(we),i=h();return r.useEffect(()=>(n&&i(G(n)),()=>{i(t())}),[n,i,t]),o?e.jsx(e.Fragment,{}):e.jsx(J,{videoList:s})},ye=({authorDisplayName:t,textDisplay:s,publishedAt:o})=>{const{ref:n,isTextShow:i,isButtonShow:c,toggleIsTextShow:a}=M();return e.jsxs("div",{className:l.comment,children:[e.jsx(V,{}),e.jsxs("div",{className:l.comment__content,children:[e.jsxs("div",{className:l.comment__header,children:[e.jsx("h3",{className:l.comment__author,children:t}),e.jsx("span",{children:Q(o).fromNow()})]}),e.jsx("p",{ref:n,className:i?l.comment__text:`${l.comment__text} ${l.comment__text_hidden}`,children:s}),c?e.jsx("button",{onClick:a,className:l.comment__open,children:i?"Свернуть":"Читать дальше"}):null]})]})},$e=({authorDisplayName:t,publishedAt:s,textDisplay:o,replies:n,totalReplyCount:i})=>{const[c,a]=r.useState(!1),{ref:m,isTextShow:u,isButtonShow:j,toggleIsTextShow:C}=M(),z=X(s),O=i?E(Number(i),"ответ","ответа","ответов"):null;return e.jsxs("div",{className:l.comment,children:[e.jsx(V,{}),e.jsxs("div",{className:l.comment__content,children:[e.jsxs("div",{className:l.comment__header,children:[e.jsx("h3",{className:l.comment__author,children:t}),e.jsx("span",{children:z})]}),e.jsx("div",{ref:m,className:u?l.comment__text:`${l.comment__text} ${l.comment__text_hidden}`,children:o}),j?e.jsx("button",{onClick:C,className:l.comment__open,children:u?"Свернуть":"Читать дальше"}):null,i?e.jsxs(e.Fragment,{children:[e.jsxs("button",{className:l.comment__button,onClick:()=>a(!c),children:[i," ",O]}),c&&n?e.jsx("ul",{className:l.comment__list,children:n.map(L=>e.jsx("li",{children:e.jsx(ye,{...L})},L.id))}):null]}):null]})]})},Pe=({commentText:t,setCommentText:s,setIsFetching:o})=>{const n=c=>{s(c.target.value)},i=c=>{c.preventDefault(),o(!0)};return e.jsxs("form",{onSubmit:i,className:N.form,children:[e.jsx("input",{value:t,onChange:n,placeholder:"Введите комментарий",className:N.form__field}),e.jsx(g,{className:N.form__button,disabled:t.length<1,children:"Оставить комментарий"})]})},Te=({videoId:t})=>{const[s,o]=r.useState(!1),[n,i]=r.useState(""),c=h();return r.useEffect(()=>{s&&(c(Z({videoId:t,text:n})),i(""),o(!1))},[c,s]),e.jsx(Pe,{commentText:n,setCommentText:i,setIsFetching:o})},Ee=()=>e.jsxs("div",{className:$.form,children:[e.jsx("h3",{className:$.from__title,children:"Чтобы оставить комментарий к этому видео, войдите в аккаунт"}),e.jsx(v,{})]}),Re=({videoId:t,nextPageToken:s,loading:o,isAuth:n,commentList:i})=>{const{ref:c,inView:a}=ee({threshold:.9}),m=h();return r.useEffect(()=>{a&&m(D({videoId:t,token:s,maxResults:20}))},[a]),e.jsxs(e.Fragment,{children:[e.jsx(r.Suspense,{children:n?e.jsx(Te,{videoId:t}):e.jsx(Ee,{})}),e.jsx("ul",{className:P.list,children:i.map((u,j,C)=>e.jsx("li",{ref:j===C.length-1?c:null,children:e.jsx($e,{...u})},u.id))}),o&&e.jsx("div",{className:P.preloader,children:e.jsx(be,{})})]})},Ae=({videoId:t})=>{const{clearCommentList:s}=ie,o=d(F),n=d(se),i=d(te),c=d(ne),a=d(oe),m=h();return r.useEffect(()=>(m(D({videoId:t,token:i,maxResults:40})),()=>{m(s())}),[]),a?e.jsx("div",{children:a}):c&&!n.length?e.jsx(e.Fragment,{}):e.jsx(Re,{videoId:t,commentList:n,nextPageToken:i,loading:c,isAuth:o})},De=t=>r.createElement("svg",{width:"800px",height:"800px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},r.createElement("path",{d:"M8 10V20M8 10L4 9.99998V20L8 20M8 10L13.1956 3.93847C13.6886 3.3633 14.4642 3.11604 15.1992 3.29977L15.2467 3.31166C16.5885 3.64711 17.1929 5.21057 16.4258 6.36135L14 9.99998H18.5604C19.8225 9.99998 20.7691 11.1546 20.5216 12.3922L19.3216 18.3922C19.1346 19.3271 18.3138 20 17.3604 20L8 20",stroke:"#000000",strokeWidth:.6,strokeLinecap:"round",strokeLinejoin:"round"})),Fe=t=>r.createElement("svg",{width:"800px",height:"800px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},r.createElement("path",{d:"M8 14V4M8 14L4 14V4.00002L8 4M8 14L13.1956 20.0615C13.6886 20.6367 14.4642 20.884 15.1992 20.7002L15.2467 20.6883C16.5885 20.3529 17.1929 18.7894 16.4258 17.6387L14 14H18.5604C19.8225 14 20.7691 12.8454 20.5216 11.6078L19.3216 5.60779C19.1346 4.67294 18.3138 4.00002 17.3604 4.00002L8 4",stroke:"#000000",strokeWidth:.6,strokeLinecap:"round",strokeLinejoin:"round"})),H=({likeCount:t,rate:s,onLikeClick:o,onDislikeClick:n})=>e.jsxs("div",{className:p.rate,children:[e.jsxs("button",{className:p.rate__button,onClick:o,children:[e.jsx(De,{className:p.rate__icon+(s==="like"?` ${p.rate__icon_active}`:"")}),e.jsx("span",{children:t})]}),e.jsx("button",{className:p.rate__button,onClick:n,children:e.jsx(Fe,{className:p.rate__icon+(s==="dislike"?` ${p.rate__icon_active}`:"")})})]}),Ie=({viewCount:t,viewNoun:s,publishedAt:o,description:n})=>{const[i,c]=r.useState(!1),a=()=>c(!0),m=u=>{u.stopPropagation(),c(!1)};return e.jsxs("div",{className:i?`${x.info} ${x.info_active}`:x.info,onClick:a,children:[e.jsxs("div",{className:x.info__statistics,children:[e.jsxs("span",{children:[t," ",s]}),e.jsx("span",{children:o})]}),e.jsx("div",{className:i?`${x.info__content} ${x.info__content_active}`:x.info__content,dangerouslySetInnerHTML:{__html:n}}),i?e.jsx("button",{className:x.info__button,onClick:m,children:"Свернуть"}):e.jsx("button",{className:x.info__button,children:"ещё..."})]})},Be=({rate:t,likeCount:s,onLikeClick:o,onDislikeClick:n})=>{const i=w(s);return e.jsx(H,{rate:t,likeCount:i,onLikeClick:o,onDislikeClick:n})},Me=({videoId:t,rate:s,...o})=>{const n=h(),i=()=>n(b({videoId:t,rate:"like"})),c=()=>n(b({videoId:t,rate:"dislike"})),a=()=>n(b({videoId:t,rate:"none"})),m=s!=="like"?i:a,u=s!=="dislike"?c:a;return e.jsx(Be,{rate:s,onLikeClick:m,onDislikeClick:u,...o})},q=({title:t,text:s,hidePopup:o,button:n})=>e.jsxs("div",{className:f.popup,children:[e.jsx("div",{className:f.popup__backdrop,onClick:o}),e.jsxs("div",{className:f.popup__body,children:[e.jsxs("div",{className:f.popup__text,children:[e.jsx("p",{children:t}),e.jsx("p",{children:s})]}),n&&e.jsx("div",{className:f.popup__button,children:n})]})]}),He=({likeCount:t,authButton:s})=>{const{isPopupVisible:o,showPopup:n,hidePopup:i}=B(),c=w(t);return e.jsxs("div",{className:ce.counter,children:[e.jsx(H,{likeCount:c,rate:"none",onLikeClick:n,onDislikeClick:n}),o&&e.jsx(q,{title:"Хотите оценить это видео?",text:"Тогда войдите в аккаунт.",hidePopup:i,button:s})]})},qe=({handleDeleteSubscription:t})=>e.jsx(g,{onClick:t,className:ae.button,children:"Отменить подписку"}),ze=({subscribeStatus:t})=>{const{clearSubscriptionStatus:s}=le,o=h(),n=()=>{o(re(t)),o(s())};return e.jsx(qe,{handleDeleteSubscription:n})},Oe=({disabled:t,handleCreateSubscription:s})=>e.jsx(g,{onClick:s,disabled:t,children:"Подписаться"}),Ue=({channelId:t})=>{const s=d(R),o=h(),n=()=>{o(de(t))};return e.jsx(Oe,{handleCreateSubscription:n,disabled:s})},We=({authButton:t})=>{const{isPopupVisible:s,showPopup:o,hidePopup:n}=B();return e.jsxs("div",{className:me.button,children:[e.jsx(g,{onClick:o,children:"Подписаться"}),s&&e.jsx(q,{title:"Хотите подписаться на этот канал?",text:"Тогда войдите в аккаунт.",hidePopup:n,button:t})]})},Ye=()=>e.jsx(I,{className:ue.skeleton}),Ge=()=>e.jsx(I,{className:he.skeleton}),Je=({videoId:t,isAuth:s,subscribeStatus:o,videoRating:n,details:{channelId:i,title:c,description:a,likeCount:m,viewCount:u,publishedAt:j}})=>e.jsxs("div",{className:_.description,children:[e.jsx("div",{className:_.description__header,children:e.jsx("h3",{className:_.description__title,children:c})}),e.jsxs("div",{className:_.description__main,children:[e.jsx(ve,{channelId:i}),e.jsxs("div",{className:_.description__controls,children:[e.jsx(r.Suspense,{fallback:e.jsx(Ge,{}),children:s?e.jsx(Me,{videoId:t,likeCount:m,rate:n}):e.jsx(He,{likeCount:m,authButton:e.jsx(v,{})})}),e.jsx(r.Suspense,{fallback:e.jsx(Ye,{}),children:s?o?e.jsx(ze,{subscribeStatus:o}):e.jsx(Ue,{channelId:i}):e.jsx(We,{authButton:e.jsx(v,{})})})]})]}),e.jsx("div",{className:_.description__footer,children:e.jsx(Ie,{description:a,...xe({publishedAt:j,viewCount:u})})})]}),Ke=({videoId:t})=>{const s=d(pe),o=d(_e),n=d(je),i=d(F),{setVideoTitle:c}=A,a=h();return r.useEffect(()=>{a(fe(t))},[a,t]),r.useEffect(()=>{i&&a(ge(t))},[a,t,i]),r.useEffect(()=>{s!=null&&s.channelId&&i&&a(Ce(s==null?void 0:s.channelId))},[s==null?void 0:s.channelId,a,i]),r.useEffect(()=>(s!=null&&s.title&&a(c(s==null?void 0:s.title)),()=>{a(c(""))}),[s==null?void 0:s.title,a,c]),s?e.jsx(Je,{details:s,isAuth:i,subscribeStatus:o,videoId:t,videoRating:n}):e.jsx(e.Fragment,{})},Qe="_page_wsqfc_1",Xe="_page__main_wsqfc_8",Ze="_page__related_wsqfc_14",k={page:Qe,page__main:Xe,page__related:Ze},ts=()=>{const t=d(Se),{id:s}=Ne();return e.jsxs("div",{className:k.page,children:[e.jsxs("div",{className:k.page__main,children:[e.jsx(Ve,{src:`https://www.youtube.com/embed/${s}`}),e.jsx(Ke,{videoId:s}),t==="mobile"&&e.jsx(T,{}),e.jsx(Ae,{videoId:s})]}),t==="desktop"&&e.jsx("div",{className:k.page__related,children:e.jsx(T,{})})]})};export{ts as ViewPage};
