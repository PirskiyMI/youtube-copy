import{r,t as v,v as E,j as e,w as S,A as w,u as m,x as T,y as U,z as W,b as x,B as Y,C as L,D as R,E as l,F as q,G,H as N,I as g,J,K as $,q as k,d as K,M as A,N as y,p as D,O as Q,Q as X,R as Z,S as ee,T as se,U as p,W as h,X as b,Y as f,Z as te,_ as ne,$ as oe,a0 as ce,a1 as ie,a2 as ae,a3 as F,a4 as re,a5 as le,a6 as j,i as de,a7 as me,a8 as ue,a9 as he,aa as xe,ab as pe,ac as je,ad as _e}from"./index-B2rtdmEb.js";import{P as fe}from"./index-zcltM7HN.js";const I=()=>{const[t,s]=r.useState(!1);return{isPopupVisible:t,showPopup:()=>s(!0),hidePopup:()=>s(!1)}},B=()=>{const[t,s]=r.useState(!1),[o,n]=r.useState(!1),c=r.useRef(null);return r.useEffect(()=>{c.current&&n(c.current.clientHeight!==c.current.scrollHeight)},[]),{isTextShow:t,isButtonShow:o,ref:c,toggleIsTextShow:()=>s(!t)}},ge=({title:t,subscriberCount:s})=>{const o=v(s),n=E(Number(s),"подписчик","подписчика","подписчиков");return e.jsxs("div",{className:S.channel,children:[e.jsx(w,{}),e.jsxs("div",{className:S.channel__info,children:[e.jsx("h4",{className:S.channel__title,children:t}),e.jsxs("span",{children:[o," ",n]})]})]})},Ce=({channelId:t})=>{m(T);const s=m(U),o=m(W),n=x();return r.useEffect(()=>{n(Y(t))},[t]),e.jsx(ge,{title:s,subscriberCount:o})},Se=({src:t})=>{const{setVideoId:s}=R,o=x();return r.useEffect(()=>{o(s(t))},[t,o]),e.jsx("div",{className:L.video,children:e.jsx("iframe",{className:L.video__iframe,src:t,title:"YouTube video player",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",referrerPolicy:"strict-origin-when-cross-origin",allowFullScreen:!0})})},Ne=({authorDisplayName:t,textDisplay:s,publishedAt:o})=>{const{ref:n,isTextShow:c,isButtonShow:i,toggleIsTextShow:a}=B();return e.jsxs("div",{className:l.comment,children:[e.jsx(w,{}),e.jsxs("div",{className:l.comment__content,children:[e.jsxs("div",{className:l.comment__header,children:[e.jsx("h3",{className:l.comment__author,children:t}),e.jsx("span",{children:q(o).fromNow()})]}),e.jsx("p",{ref:n,className:c?l.comment__text:`${l.comment__text} ${l.comment__text_hidden}`,children:s}),i?e.jsx("button",{onClick:a,className:l.comment__open,children:c?"Свернуть":"Читать дальше"}):null]})]})},be=({authorDisplayName:t,publishedAt:s,textDisplay:o,replies:n,totalReplyCount:c})=>{const[i,a]=r.useState(!1),{ref:d,isTextShow:u,isButtonShow:_,toggleIsTextShow:C}=B(),z=G(s),O=c?E(Number(c),"ответ","ответа","ответов"):null;return e.jsxs("div",{className:l.comment,children:[e.jsx(w,{}),e.jsxs("div",{className:l.comment__content,children:[e.jsxs("div",{className:l.comment__header,children:[e.jsx("h3",{className:l.comment__author,children:t}),e.jsx("span",{children:z})]}),e.jsx("div",{ref:d,className:u?l.comment__text:`${l.comment__text} ${l.comment__text_hidden}`,children:o}),_?e.jsx("button",{onClick:C,className:l.comment__open,children:u?"Свернуть":"Читать дальше"}):null,c?e.jsxs(e.Fragment,{children:[e.jsxs("button",{className:l.comment__button,onClick:()=>a(!i),children:[c," ",O]}),i&&n?e.jsx("ul",{className:l.comment__list,children:n.map(V=>e.jsx("li",{children:e.jsx(Ne,{...V})},V.id))}):null]}):null]})]})},ke=({commentText:t,setCommentText:s,setIsFetching:o})=>{const n=i=>{s(i.target.value)},c=i=>{i.preventDefault(),o(!0)};return e.jsxs("form",{onSubmit:c,className:N.form,children:[e.jsx("input",{value:t,onChange:n,placeholder:"Введите комментарий",className:N.form__field}),e.jsx(g,{className:N.form__button,disabled:t.length<1,children:"Оставить комментарий"})]})},ve=({videoId:t})=>{const[s,o]=r.useState(!1),[n,c]=r.useState(""),i=x();return r.useEffect(()=>{s&&(i(J({videoId:t,text:n})),c(""),o(!1))},[i,s]),e.jsx(ke,{commentText:n,setCommentText:c,setIsFetching:o})},we=()=>e.jsxs("div",{className:$.form,children:[e.jsx("h3",{className:$.from__title,children:"Чтобы оставить комментарий к этому видео, войдите в аккаунт"}),e.jsx(k,{})]}),Ve=({videoId:t,nextPageToken:s,loading:o,isAuth:n,commentList:c})=>{const{ref:i,inView:a}=K({threshold:.9}),d=x();return r.useEffect(()=>{a&&d(A({videoId:t,token:s,maxResults:20}))},[a]),e.jsxs(e.Fragment,{children:[e.jsx(r.Suspense,{children:n?e.jsx(ve,{videoId:t}):e.jsx(we,{})}),e.jsx("ul",{className:y.list,children:c.map((u,_,C)=>e.jsx("li",{ref:_===C.length-1?i:null,children:e.jsx(be,{...u})},u.id))}),o&&e.jsx("div",{className:y.preloader,children:e.jsx(fe,{})})]})},Le=({videoId:t})=>{const{clearCommentList:s}=se,o=m(D),n=m(Q),c=m(X),i=m(Z),a=m(ee),d=x();return r.useEffect(()=>(d(A({videoId:t,token:c,maxResults:40})),()=>{d(s())}),[]),a?e.jsx("div",{children:a}):i&&!n.length?e.jsx(e.Fragment,{}):e.jsx(Ve,{videoId:t,commentList:n,nextPageToken:c,loading:i,isAuth:o})},$e=t=>r.createElement("svg",{width:"800px",height:"800px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},r.createElement("path",{d:"M8 10V20M8 10L4 9.99998V20L8 20M8 10L13.1956 3.93847C13.6886 3.3633 14.4642 3.11604 15.1992 3.29977L15.2467 3.31166C16.5885 3.64711 17.1929 5.21057 16.4258 6.36135L14 9.99998H18.5604C19.8225 9.99998 20.7691 11.1546 20.5216 12.3922L19.3216 18.3922C19.1346 19.3271 18.3138 20 17.3604 20L8 20",stroke:"#000000",strokeWidth:.6,strokeLinecap:"round",strokeLinejoin:"round"})),ye=t=>r.createElement("svg",{width:"800px",height:"800px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},r.createElement("path",{d:"M8 14V4M8 14L4 14V4.00002L8 4M8 14L13.1956 20.0615C13.6886 20.6367 14.4642 20.884 15.1992 20.7002L15.2467 20.6883C16.5885 20.3529 17.1929 18.7894 16.4258 17.6387L14 14H18.5604C19.8225 14 20.7691 12.8454 20.5216 11.6078L19.3216 5.60779C19.1346 4.67294 18.3138 4.00002 17.3604 4.00002L8 4",stroke:"#000000",strokeWidth:.6,strokeLinecap:"round",strokeLinejoin:"round"})),M=({likeCount:t,rate:s,onLikeClick:o,onDislikeClick:n})=>e.jsxs("div",{className:p.rate,children:[e.jsxs("button",{className:p.rate__button,onClick:o,children:[e.jsx($e,{className:p.rate__icon+(s==="like"?` ${p.rate__icon_active}`:"")}),e.jsx("span",{children:t})]}),e.jsx("button",{className:p.rate__button,onClick:n,children:e.jsx(ye,{className:p.rate__icon+(s==="dislike"?` ${p.rate__icon_active}`:"")})})]}),Pe=({viewCount:t,viewNoun:s,publishedAt:o,description:n})=>{const[c,i]=r.useState(!1),a=()=>i(!0),d=u=>{u.stopPropagation(),i(!1)};return e.jsxs("div",{className:c?`${h.info} ${h.info_active}`:h.info,onClick:a,children:[e.jsxs("div",{className:h.info__statistics,children:[e.jsxs("span",{children:[t," ",s]}),e.jsx("span",{children:o})]}),e.jsx("div",{className:c?`${h.info__content} ${h.info__content_active}`:h.info__content,dangerouslySetInnerHTML:{__html:n}}),c?e.jsx("button",{className:h.info__button,onClick:d,children:"Свернуть"}):e.jsx("button",{className:h.info__button,children:"ещё..."})]})},Ee=({rate:t,likeCount:s,onLikeClick:o,onDislikeClick:n})=>{const c=v(s);return e.jsx(M,{rate:t,likeCount:c,onLikeClick:o,onDislikeClick:n})},Te=({videoId:t,rate:s,...o})=>{const n=x(),c=()=>n(b({videoId:t,rate:"like"})),i=()=>n(b({videoId:t,rate:"dislike"})),a=()=>n(b({videoId:t,rate:"none"})),d=s!=="like"?c:a,u=s!=="dislike"?i:a;return e.jsx(Ee,{rate:s,onLikeClick:d,onDislikeClick:u,...o})},H=({title:t,text:s,hidePopup:o,button:n})=>e.jsxs("div",{className:f.popup,children:[e.jsx("div",{className:f.popup__backdrop,onClick:o}),e.jsxs("div",{className:f.popup__body,children:[e.jsxs("div",{className:f.popup__text,children:[e.jsx("p",{children:t}),e.jsx("p",{children:s})]}),n&&e.jsx("div",{className:f.popup__button,children:n})]})]}),Re=({likeCount:t,authButton:s})=>{const{isPopupVisible:o,showPopup:n,hidePopup:c}=I(),i=v(t);return e.jsxs("div",{className:te.counter,children:[e.jsx(M,{likeCount:i,rate:"none",onLikeClick:n,onDislikeClick:n}),o&&e.jsx(H,{title:"Хотите оценить это видео?",text:"Тогда войдите в аккаунт.",hidePopup:c,button:s})]})},Ae=({handleDeleteSubscription:t})=>e.jsx(g,{onClick:t,className:ne.button,children:"Отменить подписку"}),De=({subscribeStatus:t})=>{const{clearSubscriptionStatus:s}=ce,o=x(),n=()=>{o(oe(t)),o(s())};return e.jsx(Ae,{handleDeleteSubscription:n})},Fe=({disabled:t,handleCreateSubscription:s})=>e.jsx(g,{onClick:s,disabled:t,children:"Подписаться"}),Ie=({channelId:t})=>{const s=m(T),o=x(),n=()=>{o(ie(t))};return e.jsx(Fe,{handleCreateSubscription:n,disabled:s})},Be=({authButton:t})=>{const{isPopupVisible:s,showPopup:o,hidePopup:n}=I();return e.jsxs("div",{className:ae.button,children:[e.jsx(g,{onClick:o,children:"Подписаться"}),s&&e.jsx(H,{title:"Хотите подписаться на этот канал?",text:"Тогда войдите в аккаунт.",hidePopup:n,button:t})]})},Me=()=>e.jsx(F,{className:re.skeleton}),He=()=>e.jsx(F,{className:le.skeleton}),ze=({videoId:t,isAuth:s,subscribeStatus:o,videoRating:n,details:{channelId:c,title:i,description:a,likeCount:d,viewCount:u,publishedAt:_}})=>e.jsxs("div",{className:j.description,children:[e.jsx("div",{className:j.description__header,children:e.jsx("h3",{className:j.description__title,children:i})}),e.jsxs("div",{className:j.description__main,children:[e.jsx(Ce,{channelId:c}),e.jsxs("div",{className:j.description__controls,children:[e.jsx(r.Suspense,{fallback:e.jsx(He,{}),children:s?e.jsx(Te,{videoId:t,likeCount:d,rate:n}):e.jsx(Re,{likeCount:d,authButton:e.jsx(k,{})})}),e.jsx(r.Suspense,{fallback:e.jsx(Me,{}),children:s?o?e.jsx(De,{subscribeStatus:o}):e.jsx(Ie,{channelId:c}):e.jsx(Be,{authButton:e.jsx(k,{})})})]})]}),e.jsx("div",{className:j.description__footer,children:e.jsx(Pe,{description:a,...de({publishedAt:_,viewCount:u})})})]}),Oe=({videoId:t})=>{const s=m(me),o=m(ue),n=m(he),c=m(D),{setVideoTitle:i}=R,a=x();return r.useEffect(()=>{a(xe(t))},[a,t]),r.useEffect(()=>{c&&a(pe(t))},[a,t,c]),r.useEffect(()=>{s!=null&&s.channelId&&c&&a(je(s==null?void 0:s.channelId))},[s==null?void 0:s.channelId,a,c]),r.useEffect(()=>(s!=null&&s.title&&a(i(s==null?void 0:s.title)),()=>{a(i(""))}),[s==null?void 0:s.title,a,i]),s?e.jsx(ze,{details:s,isAuth:c,subscribeStatus:o,videoId:t,videoRating:n}):e.jsx(e.Fragment,{})},Ue="_page_1hpsj_1",We="_page__main_1hpsj_9",P={page:Ue,page__main:We},Ge=()=>{const{id:t}=_e();return e.jsxs("div",{className:P.page,children:[e.jsxs("div",{className:P.page__main,children:[e.jsx(Se,{src:`https://www.youtube.com/embed/${t}`}),e.jsx(Oe,{videoId:t}),e.jsx(Le,{videoId:t})]}),e.jsx("div",{})]})};export{Ge as ViewPage};
